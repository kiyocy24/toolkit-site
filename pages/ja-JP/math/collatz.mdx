import {Input} from "@nextui-org/input";
import {Table, TableBody, TableCell, TableHeader, TableRow} from "@nextui-org/table";
import {TableColumn} from "@nextui-org/react";
import {useState} from "react";

# コラッツ予想
任意の正の整数に対して偶数の場合は2で割り、奇数の場合は3倍して1を足す操作を繰り返すと、いずれ1に到達するという予想です。

[コラッツの予想 - Wikipedia](https://ja.wikipedia.org/wiki/%E3%82%B3%E3%83%A9%E3%83%83%E3%83%84%E3%81%AE%E4%BA%88%E6%83%B3)
<br />
<br />
<Collatz/>

export function Collatz() {
    const [value, setValue] = useState(1);
    const table = collatz(value)
    const handleChange = (e) => {
        setValue(e.target.value)
    }

    return (
        <div>
            <Input
                id={"value"}
                type={"number"}
                label={"数値"}
                placeholder={"正の数値を入力してください"}
                value={value}
                min={1}
                onChange={handleChange}
                size={"lg"}
            />
            <br/>
            <Table aria-label="Collatz operation table">
                <TableHeader columns={table.columns}>
                    {(column) => <TableColumn key={column.key}>{column.label}</TableColumn>}
                </TableHeader>
                <TableBody>
                    {table.rows.map((row) => (
                        <TableRow key={row.key}>
                            <TableCell>{row.number}</TableCell>
                            <TableCell>{row.value}</TableCell>
                            <TableCell>{row.operation}</TableCell>
                        </TableRow>
                    ))}
                </TableBody>
            </Table>
        </div>
    )
}

export function collatz(n) {
    const columns = [
        {
            key: "number",
            label: "number",
        },
        {
            key: "value",
            label: "value",
        },
        {
            key: "operation",
            label: "operation",
        }
    ]
    if (n < 1) {
        return {
            columns: columns,
            rows: []
        }
    }

    let count = 1;
    const rows = [{
        key: count,
        number: count,
        value: n,
        operation: "initial",
    }]
    while (n !== 1) {
        if (n % 2 === 0) {
            n = n / 2;
        } else {
            n = n * 3 + 1;
        }
        let operation = ""
        if (n === 1) {
            operation = "end"
        } else if (n % 2 === 0) {
            operation = "divide"
        } else {
            operation = "multiply and add"
        }
        
        count++
        rows.push({
            key: count,
            number: count,
            value: n,
            operation: operation,
        })
    }
    return {
        columns: columns,
        rows: rows
    };
}

